pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
-- main --

function _init()
	iplr() -- init player
end

function _update()
	uplr() -- update player
end

function _draw()
	cls() -- clear screen
	map() -- draw map
	dplr() -- draw player
end
-->8

-- player
 
function iplr() -- init player

	plr={
		x=63,
		y=63
	}		
end


function uplr() -- update player
	move(plr)
	
end


function dplr() -- draw player

	-- sprite number, x and y coor
	spr(2,plr.x,plr.y)
	
end
-->8
-- collision --

-- o = plr
function move(o) -- move an obj

	-- takes snapshot of player
	-- last position and 
	-- store it as a local variable
	
	local lx=o.x -- last x position
	local ly=o.y -- last y position

	-- player movement
	if (btn(0)) o.x-=1 -- left
	if (btn(1)) o.x+=1 -- right
	if (btn(2)) o.y-=1 -- down
	if	(btn(3)) o.y+=1 -- up

		-- if it collides, move back
 if collide(o) then
 
	-- if true then moves
	-- player to last valid position
 
 	o.x = lx -- last x value
 	o.y = ly -- last y value
 	
 end -- if collide end

end

function collide(o)
	
	-- grabs the edges 
	-- and stores them as variables
	local x1=o.x/8 -- top edge
	local y1=o.y/8
	local x2=(o.x+7)/8 -- bottom
	local y2=(o.y+7)/8

	-- check if any of the edges
	-- are touching a tile on the
	-- map with flag 0 (layer)
	local a=fget(mget(x1,y1),0)
	local b=fget(mget(x1,y2),0)
	local c=fget(mget(x2,y2),0)
	local d=fget(mget(x2,y1),0)



	if a or b or c or d then
	
	-- if return true 
	-- then player is colliding
	-- collide(o) gets call 
	-- and player return to
	-- last valid position
	
		return true
		
	else
	-- if player is not colliding
	-- then collide(0) is false
		 return false
		 
	end
	
end


__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000110011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000118811000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000000000000c11c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000011110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000110011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000655556553333333333333333333333333333333300000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000554455463333333337333333333333333333333300000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000054465544343434437a733333333333333333433300000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000445445544430434437333333333333333334343300000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000444444444344444433333733333333333343343300000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000444444444044444433337a73333333333433333300000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000444444444444404433333733333333334333333300000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000444444444444444433333333333333333333333300000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000003454454334444453333333330000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000444444445454444433bb33330000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000004454444444444444333b33330000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000005444445445444545333333b30000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000044454444444544443bb33bb30000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000444444444544444433bb3b330000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000004444445444444454333b33330000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000003444544335455443333333330000000000000000000000000000000000000000
__gff__
0000000000000000000000000000000000000000000000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
181818181818181818181818181818181a1a1a1a1a1a1a1a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1a1a1a1a1a19191a1a2a1a2a1a1a1a1a1a1a1a1a1a1a1a1a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1a17171717171a1a1717171a1a1717171a1a1a1a1a1a1a1a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2a2a1a1a1a1a1a2a1a2a1a2a2a2a1a1a1a1a1a1a1a1a1a1a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1a171a1a171a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2a1a2a2a1a1a1a2a1a1a1919181a1a1a1a1a1a1a1a1a1a1a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1a1717171a19191a171a1919181a1a1a1a1a1a1a1a1a1a1a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1a1a1a1a1a19191a1a2a2a1a1a1a2a1a1a1a1a1a1a1a1a1a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
