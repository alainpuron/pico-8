pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
-- main --

function _init()
	iplr() -- init player
	ipickups()
end

function _update()
	uplr() -- update player
	upickups()
end

function _draw()
	cls() -- clear screen
	map() -- draw map
	dplr() -- draw player
	dpickups()
end
-->8

-- player
 
function iplr() -- init player

	plr={
		x=63,
		y=63
	}		
end


function uplr() -- update player
	move(plr)
	
end


function dplr() -- draw player

	-- sprite number, x and y coor
	spr(2,plr.x,plr.y,2,2)
	
end
-->8
-- collision --

-- o = plr
function move(o) -- move an obj

	-- takes snapshot of player
	-- last position and 
	-- store it as a local variable
	
	local lx=o.x -- last x position
	local ly=o.y -- last y position

	-- player movement
	if (btn(0)) o.x-=1 -- left
	if (btn(1)) o.x+=1 -- right
	if (btn(2)) o.y-=1 -- down
	if	(btn(3)) o.y+=1 -- up

		-- if it collides, move back
 if collide(o) then
 
	-- if true then moves
	-- player to last valid position
 
 	o.x = lx -- last x value
 	o.y = ly -- last y value
 	
 end -- if collide end

end

function collide(o)
	
	-- grabs the edges 
	-- and stores them as variables
	local x1=o.x/8 -- top edge
	local y1=o.y/8
	local x2=(o.x+7)/8 -- bottom
	local y2=(o.y+7)/8

	-- check if any of the edges
	-- are touching a tile on the
	-- map with flag 0 (layer)
	local a=fget(mget(x1,y1),0)
	local b=fget(mget(x1,y2),0)
	local c=fget(mget(x2,y2),0)
	local d=fget(mget(x2,y1),0)



	if a or b or c or d then
	
	-- if return true 
	-- then player is colliding
	-- collide(o) gets call 
	-- and player return to
	-- last valid position
	
		return true
		
	else
	-- if player is not colliding
	-- then collide(0) is false
		 return false
		 
	end
	
end


-->8
-- pickup objects

function ipickups()

	pu={
		y=63,
		y=50,
		act=true,
	}
	
	donuts=0
end

function upickups()

	if pu.act then
	 -- if player position is 4
	 -- or less to the obj
	 -- then pick up
	 
		 -- abs = absolute value
			if abs(plr.x-pu.x)<=4 and abs(plr.y-pu.y)<=4 then
						pu.act=false
						donuts+=1
			end
	end
end

function dpickups()
	
	if pu.act then
		spr(9,pu.x,pu.y,2,2)
	end
	
	print("donuts: "..donuts,10,10,7)

end
__gfx__
00000000000000000000011111111000000001111111100001111111100000000000000033333333333333333333333333111133333333333111133300000000
00000000000000000000144444444100000014444444410014444444410000000000000033333333333333333333333331ffff133333b3331b3b713300000000
000000000000000000014444444410000001444444441000014444444100000000000000333333333333333333333333316ff613333b333331bbb71300000000
000000000000000000144444444441000014444444444100001ffffff41000000000000033333311111333333333333331566413b33b33b331b3bb7100000000
0000000000000000001f44ffff44f100001f44ffff44f100001cfffff410000000000000333331eeede1333333333333315444133b333b3313bbbb1300000000
0000000000000000001fffcffcfff100001fffcffcfff100001cfffff41000000000000033331eaee8ee133333333333331441333b333b331bbbb3b100000000
00000000000000000001ffcffcff10000001ffcffcff1000001ffffff4100000000000003331eeeeeeeae1333333333333144133333333333144441300000000
00000000000000000001f444444f10000001f444444f10000018444fff100000000000003331de8433eee1333333333333311333333333333344443300000000
0000000000000000000001488410000000000148841000000014666666100000000000003331eee333ede1333333333333333333333333333333333300000000
000000000000000000001144441100000000114444110000001466ff66100000000000003331eae333eee1333333333113333333333333333333333300000000
00000000000000000001ff4444ff10000001ff4444ff100000016fff661000000000000033331eee8ee813333333331bb1333333333333333333333300000000
00000000000000000001ff6116ff10000001ff6116ff100000016fff6610000000000000333331deeae133333333331bb1333333333333333333333300000000
0000000000000000000016666661000000001666666100000001cccccc100000000000003333331111133333333331bbb3133333333333333333333300000000
000000000000000000001cccccc1000000001cccccc100000001cccccc100000000000003333333333333333333331bbb3113333333333333333333300000000
000000000000000000001cc11cc1000000001cc11cc100000000111ccc10000000000000333333333333333333331bbbb3313333333333333333333300000000
000000000000000000000110011000000000000001100000000000011100000000000000333333333333333333331bbbbb331333333333333333333300000000
0000000000000000000000000000000000000000000000000000000000000000cccccccccccccccccccccccc3331bbb3bbb31333333333333333333300000000
0000000000000000000000000000000000000000000000000000000000000000cccccccccccccccccccccccc331bbbb3bbb331333333337fff33333300000000
0000000000000000000000000000000000000000000000000000000000000000cccccccccccccccccccccccc31bbbb3bbbbb3313333337f66ff3333300000000
0000000000000000000000000000000000000000000000000000000000000000ccccccccccc76ccccccccccc31bbb33bb3b3331333335ff66ff4333300000000
0000000000000000000000000000000000000000000000000000000000000000cccccccccc7776cccccccccc3311118844111133333354ffff44333300000000
0000000000000000000000000000000000000000000000000000000000000000cccccccccc7777cccccc77773333318444133333333844544404433300000000
0000000000000000000000000000000000000000000000000000000000000000ccccccccccc77ccccccccccc3333318444133333334855544544443300000000
0000000000000000000000000000000000000000000000000000000000000000ccccccccccccccc777cccccc3333318444133333338444404450443300000000
000000000000000000000000000000000000000000000000000000000000000000000000cccccccccccccccc0000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000ccccccccccc67ccc0000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000cccccccccc6777cc0000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000cccccccccc7777cc0000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000cccc777cccc77ccc0000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000cccccccccccccccc0000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000cccccccccccccccc0000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000cccccccccccccccc0000000000000000000000000000000000000000
__gff__
0000000000000000000000000100000000000000000000010100000000000000000000000000000000000000000101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0b0b0b0b0b0b0b0b0b1b1c0c1d1e1d1e0b0b0c0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0b0b0d0b0b0b0d0b0d2b2c0c2d2e2d2e0b0b0c0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0c0c0c0c0c0b0c0c0c0c0c0c0b0b0b0d0b0b0c0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0b0b0b0b0b0b0b0b0b0b0b0b0b0b0d0b0b0b0c0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0b0b0b0d0d0b0b0b0b0b0b0b0b0c0c0c0c0c0c0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0b0b0b1d1e0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0c0c0c0c0c0c0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1b1c1b1c1b1c0b0b0b0b0b0b0b0b0b0d0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2b2c2b2c2b2c0b0b0b0b0b0b0d0b0b0b0b0b0d0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0b0b0b0b0b0b0b0b0b0b0b0b0b0b0d0d0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0b0b0b0b0b0b0b0b0d0d0d0d0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
282828282828282828282828282828282828280b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
283a2828282828282a282828292a28282828280b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
282828282829282828282828282828282828280b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
28282a282828282828283a28283928282928280b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
282828282828283928282839282828282828280b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
