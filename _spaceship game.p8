pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
function _init()

  player_init()
  bullet_init()
  asteroid_init()

end

function _update()
	player_update() 
	bullet_update()
	asteroid_update()
end

function _draw()
  cls()

	player_draw(plr)
	bullet_draw()
	asteroid_draw()
end

-->8
-- player --
function player_init()

	plr={
	angle=0,
	cx=64,
	cy=64,
	vx=0,
	vy=0,
	r = 6

	
	}
	
end

function player_update()
	move(plr)
end

function player_draw(plr)

-- angle of rotation (should be updated each frame)
-- assume angle is already defined

-- calculate triangle points
x1 = plr.cx + cos(plr.angle) * plr.r
y1 = plr.cy + sin(plr.angle) * plr.r

x2 = plr.cx + cos(plr.angle + 0.66) * plr.r
y2 = plr.cy + sin(plr.angle + 0.66) * plr.r

x3 = plr.cx + cos(plr.angle + 1.32) * plr.r
y3 = plr.cy + sin(plr.angle + 1.32) * plr.r


-- draw triangle
line(x1, y1, x2, y2, 13) -- right
line(x2, y2, x3, y3, 6) -- bottom
line(x3, y3, x1, y1, 13) -- left
print(plr.angle)


end


function move(plr)

  
  if btn(âŽ) then
  	plr.vx += cos(plr.angle) * 2
  	plr.vy += sin(plr.angle) * 2
  end
  

  
  if btn(â¬…ï¸) then
  plr.angle -= 0.05
  end
  
  if btn(âž¡ï¸) then
  	plr.angle += 0.05
  end
  
-- apply friction every frame
		plr.vx *= 0.75
		plr.vy *= 0.75
  
  plr.cx += plr.vx 
  plr.cy += plr.vy   

		-- when out of screen
  plr.cx = (plr.cx+128)%128
  plr.cy = (plr.cy+128)%128

  
end
-->8
-- bullet --

function bullet_init()
	
	-- table for bullets
	bullets={}
end

function bullet_update()

	shoot(plr)
	for b in all(bullets) do
	
	-- bullet position 
		b.x+=b.spdx 
		b.y+=b.spdy
		
	-- if bullet is out of 
		if b.x > 128
			then
			del(bullets,b)
		end
		
		
	end	
end

function bullet_draw()

	-- draw each bullet to the scr
	for b in all(bullets) do
	
	-- spr, x,y
		spr(16,b.x,b.y)
	
	end	
	
end

function shoot(plr)

	if btnp(ðŸ…¾ï¸) then
	
	add(bullets, {
	x= x1 -3 ,  
	y= y1 -7 , 
	spdx = plr.vx + cos(plr.angle)*3,
	spdy = plr.vy + sin(plr.angle)*3
	
	})

	end
	
end


-->8
-- asteroid creation --
function asteroid_init()

	-- asteroids table
	asteroids={}
	creation_time=0
end

function asteroid_update()

	creation_time+=1
	if creation_time >= 30 then
	add(asteroids, {
	x=rnd(128) ,  
	y=rnd(5) , 
	speed = 0.7,
	sprite = rnd({44,45,60}),
	health = 10
	
	})
		creation_time=0

end

	for a in all(asteroids) do
	
	--	a.x+=a.speed 
		a.y+=a.speed
		
		if a.x > 128
			then
			del(asteroids,a)
		end
			
	end	
	
end

function asteroid_draw()
	
		for a in all(asteroids) do
	
			spr(a.sprite,a.x,a.y,1,1)
	
		end	

end
__gfx__
77777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0001d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007777000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000777000070000700000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007000700700000070000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007000700700000070000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007000700700000070000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000777000700000070000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000070000700000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007777000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000070700000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000070700000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000
