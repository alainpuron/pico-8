pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
-- can move?
-- can jump?
-- gravity?
-- collitions
-- can collect?
-- next level



-- game --

function _init()
	map_setup()
	player_init()
end

function _update()

	player_update()

end

function _draw()

cls()
draw_map()
player_draw()

print(fget(tile,tile_type))
print(mget(plr.x,plr.y))
print(mget(flr(plr.x +3)/8,flr(plr.y+7)/8))

end
-->8
-- world --

function map_setup()
	
	-- tile type
	wall=0 --flag
	
end

function draw_map()
		mapx=flr(plr.x/16)*16 -- w of map
		mapy=flr(plr.y/16)*16	-- h of map
 	map(0,0,0,0,128,64) -- size

end

-- what tile is it?

function is_tile(tile_type,x,y)

		-- what spr is the tile 
		tile =	mget(flr(x),flr(y))
		
		-- tile has flag
		has_flag = fget(tile,tile_type)

		-- if true
		return has_flag

end


--i can move only if
--the tile at x,y is not a wall.

function can_move(x,y)
	tile_size = 8
	
local	x1 =	x / tile_size
local	y1 = y / tile_size
local	x2 = (x + 7) / tile_size
local	y2 = (y + 7) / tile_size
	
	-- tile is not wall
	
		return not
		
		 (
		  is_tile(wall,x1,y1) or
		  is_tile(wall,x2,y1) or
		  is_tile(wall,x1,y2) or
		  is_tile(wall,x2,y2)
		  
		 ) 

end


function gravity()

	grav = 1
	--if mget((plr.x+7)/8,(plr.y+8)/8) ~=32 then
	
	if  can_move(plr.x,plr.y+grav) then
		plr.y += grav
	end
		
end
-->8
-- player --

function player_init()

 -- player table
	plr={}
	plr.x = 2
	plr.y	=	5
	plr.jump = 5
	plr.speed = 1
	plr.sp = 0
	jump_timer = 0
	
	
end

function player_update()
	move(plr)
	gravity()
end

function player_draw()
spr(plr.sp,plr.x,plr.y,1,1)
end
-->8
-- movement --
function move(plr)
	
	lastx = plr.x
	lasty = plr.y
	jump_timer+=1

	if (btn(⬅️)) plr.x-=plr.speed
	if (btn(➡️)) plr.x+=plr.speed
	if (btn(⬆️)) plr.y-=plr.speed
	if (btn(⬇️)) plr.y+=plr.speed
	
	
--	if jump_timer >= 5 then
		if(btn(❎)) plr.y-=plr.jump
--		jump_timer = 0
--	end
	

	
	-- if player can not move
	-- then move to last position
	if not can_move(plr.x,plr.y) then
	 plr.x = lastx
		plr.y = lasty 
	end

end


__gfx__
11111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccccccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010102010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010201020102010201020101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
